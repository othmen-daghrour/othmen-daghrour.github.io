<!DOCTYPE html>
<html>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
<script type="text/javascript" src="https://unpkg.com/xlsx@0.15.1/dist/xlsx.full.min.js"></script>
<link rel="stylesheet" href="style.css">
<body>
    <div>
    			
        <input type="file" id="excel_file" />

    </div>
<div class="Main_Stats_Container">

<div class="stats_container">
    <h2>معتمدية بني خلاد</h2>
    <canvas id="myChartBK" style="width:100%;max-width:600px"></canvas>   
</div>

<div class="stats_container">
    <h2>معتمدية الحمامات</h2>
    <canvas id="myChartHA" style="width:100%;max-width:600px"></canvas>   
</div>

<div class="stats_container">
    <h2>معتمدية تاكلسة</h2>
    <canvas id="myChartTA" style="width:100%;max-width:600px"></canvas>   
</div>

<div class="stats_container">
    <h2>معتمدية قرمبالية</h2>
    <canvas id="myChartGR" style="width:100%;max-width:600px"></canvas>   
</div>

<div class="stats_container">
    <h2>معتمدية منزل بوزلفة</h2>
    <canvas id="myChartMB" style="width:100%;max-width:600px"></canvas>   
</div>

<div class="stats_container">
    <h2>معتمدية سليمان</h2>
    <canvas id="myChartSO" style="width:100%;max-width:600px"></canvas>   
</div>

<div class="stats_container">
    <h2>معتمدية بوعرقوب</h2>
    <canvas id="myChartBO" style="width:100%;max-width:600px"></canvas>   
</div>

</div>


<script>
//Béni Khalled
var xValuesBK = [
'نورس  عيساوي', 
'جنات  السعداني',
'مروة  البراني',
'سيرين  سعداوي',
'غاده  شّمام',
'سمية  أسودي',
'نذير  الجربي',
'حسان  اللواتي',
'هنادي  أسودي',
'وفاء  عرفاوي',
'علاءالدين  السبوعي',
'أحلام  الدريدي',
];
var yValuesBK = [8,8,8,1,8,0,8,8,16,8,8,8];


//Hammamet
var xValuesHA = ["هيفاء  بنخصيب","رحمة  بوعافية","عواطف  جرودي","محمد  الظاهري","صبرين  الشامخي",
"ايمان  النفزي",
"ندى  بلقاسمي",
"عادل  بنحميده",
"سندس   سلامي",
"ايناس  خميسي",
"وئام  ضفلي",
'أمير  المزلوط',
'سندة  بسباس',];
var yValuesHA = [8,8,8,8,8,8,8,8,8,8,8,8,8];

//Takelsa
var xValuesTA = ["فـــرح  المغربي",
"حلمي  الزيادي",
"عزمي  بنالحاج صالح",
'سيف الدين  العميري',         
"مروان  مشرقي", 
"ذكرى  بوذينة", 
"سندس   الشرعبي",
"لندة  الكافي",];
var yValuesTA = [8,8,8,8,8,1,2,0,];

//Gromeblia
var xValuesGR = ["جميلة  رايسي",
"نورالهدى  عيساوي",
"فداء  المحمدي",
"سهيلة  بن ميرة",
"مريم  عبيد",
"سارة  بن محمد",
'لمية  باسطي',
'يسر  الغربي',
'محمدعلي  رايسي',
'اسلام  الفارحي',
'اسلام  همادي',
'مروى  المبروكي',
'سيرين  الفيضة',];
var yValuesGR = [8,8,8,8,8,8,8,8,8,8,8,8,8,];

//Menzel Bouzela
var xValuesMB = ['فدوى  بوعنان',
'أمل  العويني',
'آمال  بنحزاز',
'محمد ايهاب  الحمامي',
'حسام الدين  بن محمد',
'وئام  الكبير',
'سحر  شوشان',
'سوار  بن زيد',
'ريم  دبش', 
];
var yValuesMB = [8,8,8,8,8,8,8,8,8];

//Soliman
var xValuesSO = ["نورالهدى  الدلاجي",
'مليكة  عنقود',
'سعاد  الأجدل',
'زكية  شورابي',
'منيرة  الجبالي',
'لطيفة  بوصلاح',
'سوار  المثلوثي',
'هناء  بن صالح',
'محمد علي  الشماخي',
'شيماء  الداهش',
'جيهان  بريك',
'العادل  بوصلاح',
'يوسف  الماجري',];
var yValuesSO = [8,8,8,8,8,8,8,8,8,8,8,8,8];

//Bou Argoub
var xValuesBO = ['مريم  يحي',
'رهام  حمادة',
'سامي  السعدي',
'اية  الساسي',
'ريان  بنعثمان',
'ملاك  بن موسى',
'احلام  بومنيجل',
"صفاء  الاسود",
'هديل  بن فرح',
'آية  لسود',];
var yValuesBO = [8,8,8,8,8,8,8,8,8,8,];

//Béni Khalled
new Chart("myChartBK", {
  type: "bar",
  data: {
    labels: xValuesBK,
    datasets: [{
      backgroundColor: 'blue',
      data: yValuesBK
    }]
  },
  options: {
    legend: {display: false
    ,title:'title'
},
    title: {
      display: true,
      text: "عدد التحينات اليومية لكل عون تحيين",
      color:'Red'
    }
  }
});

//Hammamet
new Chart("myChartHA", {
  type: "bar",
  data: {
    labels: xValuesHA,
    datasets: [{
      backgroundColor: 'Red',
      data: yValuesHA
    }]
  },
  options: {
    legend: {display: false
    ,title:'title'
},
    title: {
      display: true,
      text: "عدد التحينات اليومية لكل عون تحيين",
      color:'red'
    }
  }
});

//Takelsa
new Chart("myChartTA", {
  type: "bar",
  data: {
    labels: xValuesTA,
    datasets: [{
      backgroundColor: 'Green',
      data: yValuesTA
    }]
  },
  options: {
    legend: {display: false
    ,title:'title'
},
    title: {
      display: true,
      text: "عدد التحينات اليومية لكل عون تحيين",
      color:'red'
    }
  }
});

//Grombelia
new Chart("myChartGR", {
  type: "bar",
  data: {
    labels: xValuesGR,
    datasets: [{
      backgroundColor: 'Yellow',
      data: yValuesGR
    }]
  },
  options: {
    legend: {display: false
    ,title:'title'
},
    title: {
      display: true,
      text: "عدد التحينات اليومية لكل عون تحيين",
      color:'red'
    }
  }
});

//Menzel Bouzela
new Chart("myChartMB", {
  type: "bar",
  data: {
    labels: xValuesMB,
    datasets: [{
      backgroundColor: 'Purple',
      data: yValuesMB
    }]
  },
  options: {
    legend: {display: false
    ,title:'title'
},
    title: {
      display: true,
      text: "عدد التحينات اليومية لكل عون تحيين",
      color:'red'
    }
  }
});

//Soliaman
new Chart("myChartSO", {
  type: "bar",
  data: {
    labels: xValuesSO,
    datasets: [{
      backgroundColor: 'Brown',
      data: yValuesSO
    }]
  },
  options: {
    legend: {display: false
    ,title:'title'
},
    title: {
      display: true,
      text: "عدد التحينات اليومية لكل عون تحيين",
      color:'red'
    }
  }
});

//Bou Argoub
new Chart("myChartBO", {
  type: "bar",
  data: {
    labels: xValuesBO,
    datasets: [{
      backgroundColor: 'Blue',
      data: yValuesBO
    }]
  },
  options: {
    legend: {display: true
    ,text:'title'
},
    title: {
      display: true,
      text: "عدد التحينات اليومية لكل عون تحيين",
      color:'Red'
    }
  }
});

const excel_file = document.getElementById('excel_file');

excel_file.addEventListener('change', (event) => {

    if(!['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'application/vnd.ms-excel'].includes(event.target.files[0].type))
    {
        document.getElementById('excel_data').innerHTML = '<div class="alert alert-danger">Only .xlsx or .xls file format are allowed</div>';

        excel_file.value = '';

        return false;
    }

    var reader = new FileReader();

    reader.readAsArrayBuffer(event.target.files[0]);

    reader.onload = function(event){

        var data = new Uint8Array(reader.result);

        var work_book = XLSX.read(data, {type:'array'});

        var sheet_name = work_book.SheetNames;

        var sheet_data = XLSX.utils.sheet_to_json(work_book.Sheets[sheet_name[0]], {header:1});

        console.log(sheet_data);
       

    }});

</script>

</body>
</html>
